!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("PIXI")):"function"==typeof define&&define.amd?define("PotatoParticles",["PIXI"],t):"object"==typeof exports?exports.PotatoParticles=t(require("PIXI")):e.PotatoParticles=t(e.PIXI)}(window,(function(e){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(t,i){t.exports=e},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var r=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=i}return n(e,[{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"setX",value:function(e){this.x=e}},{key:"setY",value:function(e){this.y=e}},{key:"add",value:function(t){this.x=e.roundAxis(this.x+t.x),this.y=e.roundAxis(this.y+t.y)}},{key:"subtract",value:function(t){this.x=e.roundAxis(this.x-t.x),this.y=e.roundAxis(this.y-t.y)}},{key:"multiply",value:function(t){this.x=e.roundAxis(this.x*t),this.y=e.roundAxis(this.y*t)}},{key:"divide",value:function(t){this.x=e.roundAxis(this.x/t),this.y=e.roundAxis(this.y/t)}},{key:"value",value:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"normalize",value:function(){var e=this.value();0!==e?(this.x/=e,this.y/=e):(this.x=0,this.y=0)}},{key:"clone",value:function(){return new e(this.x,this.y)}}],[{key:"add",value:function(e,t){var i=e.clone();return i.add(t),i}},{key:"subtract",value:function(e,t){var i=e.clone();return i.subtract(t),i}},{key:"multiply",value:function(e,t){var i=e.clone();return i.multiply(t),i}},{key:"divide",value:function(e,t){var i=e.clone();return i.divide(t),i}},{key:"roundAxis",value:function(e){return Math.round(1e5*e)/1e5}}]),e}();t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(3);var n,r=i(4);var a=((n=r)&&n.__esModule?n:{default:n}).default;t.default=a},function(e,t,i){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),a=u(i(5)),s=u(i(1)),o=u(i(6));function u(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){var i=this,n=t.rootEl,r=t.imageSrc,s=t.pixelSize,o=void 0===s?10:s,u=t.particleSize,h=void 0===u?6:u,l=t.resistance,c=void 0===l?-.7:l,d=t.minMass,f=void 0===d?4:d,v=t.massRand,p=void 0===v?2:v,y=t.delayRand,g=void 0===y?.4:y,m=t.pixelFilter,x=t.particleInit,w=t.mouseInteraction,b=void 0===w||w;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootEl=n,this.pixelSize=o,this.particleSize=h,this.resistance=c,this.minMass=f,this.massRand=p,this.delayRand=g,this.pixelFilter=m,this.particleInit=x,this.mouseInteraction=b,this.imageHelper=new a.default,this.imageHelper.load(r).then((function(e){i.onLogoLoaded(e),i.logoImage=e}))}return n(e,[{key:"onLogoLoaded",value:function(e){this.logoImage=e,this.width=this.logoImage.width,this.height=this.logoImage.height,this.particlesData=this.imageHelper.imageToDots({width:this.width,height:this.height,pixelSize:this.pixelSize,pixelFilter:this.pixelFilter}),this.mouseVector=new s.default(0,0),this.initRenderer(),this.initParticles(),this.renderer.render(this.stage),this.startLoop(),this.calculateScale(),this.bindEvents(),this.setParticlesTargets()}},{key:"initRenderer",value:function(){this.ticker=r.Ticker.shared,this.renderer=new r.Renderer({width:this.width,height:this.height,transparent:!0}),this.renderer.context.mozImageSmoothingEnabled=!1,this.renderer.context.webkitImageSmoothingEnabled=!1,this.rootEl.appendChild(this.renderer.view),this.stage=new r.Container,this.particleContainer=new r.Container,this.stage.addChild(this.particleContainer)}},{key:"initParticles",value:function(){this.particles=[];for(var e=this.particlesData.length,t=this.getShared(),i=this.particleInit||function(){return{}},n=0;n<e;n++){var a=this.particlesData[n],s=r.utils.rgb2hex([a.r,a.g,a.b]);this.particles.push(new o.default(this.particleContainer,Object.assign({x:t.avgX,y:t.avgY,mass:Math.random()*t.massRand+t.minMass,texture:this.createCircleTexture(t.particleSize/2,s,1),delay:(t.rangeY-(a.y-t.minY))*(2/t.rangeY)+Math.random()*t.delayRand},i(a,t))))}}},{key:"getShared",value:function(){for(var e=this.particlesData.length,t=this.particleSize,i=this.minMass,n=this.massRand,r=this.delayRand,a=0,s=0,o=this.particlesData[0].x,u=0,h=this.particlesData[0].y,l=0,c=0;c<e;c++){var d=this.particlesData[c];a+=d.x,s+=d.y,d.x<o&&(o=d.x),d.x>u&&(u=d.x),d.y<h&&(h=d.y),d.y>l&&(l=d.y)}return{width:this.width,height:this.height,halfWidth:this.width/2,halfHeight:this.height/2,particlesCount:e,particleSize:t,minMass:i,massRand:n,delayRand:r,minX:o,minY:h,maxX:u,maxY:l,sumX:a,sumY:s,avgX:a/e,avgY:s/e,rangeX:u-o,rangeY:l-h}}},{key:"createCircleTexture",value:function(e,t,i){var n=new r.Graphics;n.beginFill(t,i),n.drawCircle(0,0,e),n.endFill();var a=this.renderer.generateTexture(n);return n.clear(),n.destroy(),a}},{key:"calculateScale",value:function(){var e=this.rootEl.getBoundingClientRect();this.scale=this.width/e.width}},{key:"setParticlesTargets",value:function(){for(var e=this.particlesData.length,t=0;t<e;t++){var i=this.particlesData[t];this.particles[t].setTarget(new s.default(i.x,i.y))}}},{key:"bindEvents",value:function(){window.addEventListener("resize",this.onResize.bind(this)),this.mouseInteraction&&window.addEventListener("mousemove",this.onMouseMove.bind(this))}},{key:"onResize",value:function(){this.calculateScale()}},{key:"onMouseMove",value:function(e){var t=this.rootEl.getBoundingClientRect();this.mouseVector.set(e.clientX-t.left,e.clientY-t.top),this.mouseVector.multiply(this.scale)}},{key:"startLoop",value:function(){this.ticker.add(this.tick.bind(this))}},{key:"tick",value:function(e){this.update(e),this.render(1)}},{key:"update",value:function(e){for(var t=this.particles.length,i=0;i<t;i++){var n=this.particles[i];n.addForce(n.getForceToTarget()),this.mouseInteraction&&n.addForce(n.getMouseForce(this.mouseVector)),n.addForce(s.default.multiply(n.velocity,this.resistance)),n.update(e)}}},{key:"render",value:function(e){for(var t=this.particles.length,i=0;i<t;i++)this.particles[i].render(e);this.renderer.render(this.stage)}}]),e}();t.default=h},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isImageLoaded=!1,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}return n(e,[{key:"load",value:function(e){var t=this;return this.isImageLoaded=!1,new Promise((function(i){var n=new Image;n.onload=function(e){var n=e.target;t.onImageLoaded(n),i(n)},n.src=e}))}},{key:"onImageLoaded",value:function(e){this.image=e,this.width=this.image.width,this.height=this.image.height,this.isImageLoaded=!0}},{key:"checkImage",value:function(){return!!this.isImageLoaded}},{key:"imageToDots",value:function(e){if(!this.checkImage())return null;var t=this.image,i=e.width,n=void 0===i?t.width:i,r=e.height,a=void 0===r?t.height:r,s=e.pixelSize,o=void 0===s?1:s,u=e.pixelFilter,h=void 0===u?function(e){return e.a>=.4}:u,l=Math.ceil(n/o),c=Math.ceil(a/o);return this.canvas.setAttribute("width",l),this.canvas.setAttribute("height",c),this.imageToData(t,{canvasWidth:l,canvasHeight:c,pixelSize:o,pixelFilter:h})}},{key:"imageToData",value:function(e,t){var i=t.canvasWidth,n=t.canvasHeight,r=t.pixelSize,a=t.pixelFilter;this.ctx.clearRect(0,0,i,n),this.drawImageCover(e,i,n);for(var s=this.ctx.getImageData(0,0,i,n).data,o=[],u=0;u<n;u++)for(var h=0;h<i;h++){var l=4*(u*i+h),c={x:h*r,y:u*r,r:s[l+0]/255,g:s[l+1]/255,b:s[l+2]/255,a:s[l+3]/255};a(c)&&o.push(c)}return o}},{key:"drawImageCover",value:function(e,t,i){var n=Math.min(t/e.width,i/e.height),r={width:e.width*n,height:e.height*n},a={x:(t-r.width)/2,y:(i-r.height)/2};this.ctx.drawImage(e,0,0,e.width,e.height,a.x,a.y,r.width,r.height)}}]),e}();t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),s=i(1),o=(n=s)&&n.__esModule?n:{default:n};var u=function(){function e(t,i){var n=i.x,r=i.y,a=i.mass,s=void 0===a?1:a,u=i.texture,h=i.delay;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.position=new o.default(n,r),this.velocity=new o.default(0,0),this.acceleration=new o.default(0,0),this.force=new o.default(0,0),this.mass=s,this.target=this.position.clone(),this.waitFrames=60*h,this.waiting=this.waitFrames>0,t&&this.createSprite(t,{texture:u})}return r(e,[{key:"createSprite",value:function(e,t){var i=t.texture;this.sprite=new a.Sprite(i),this.sprite.anchor.set(.5),this.sprite.position.set(this.position.x,this.position.y),e.addChild(this.sprite)}},{key:"addForce",value:function(e){e&&this.force.add(e)}},{key:"setTarget",value:function(e){this.target=e}},{key:"getForceToTarget",value:function(){if(!this.target)return null;var e=o.default.subtract(this.target,this.position);return e.multiply(.04),e}},{key:"getMouseForce",value:function(e){var t=o.default.subtract(e,this.position),i=t.value();t.normalize();var n=120/i,r=n*n-.04,a=r<0?0:.8*r;return t.multiply(-a),t}},{key:"update",value:function(e){if(this.waiting){if(this.waitFrames-=e,this.waitFrames>0)return;return this.waitFrames=0,this.waiting=!1,void this.force.set(0,0)}this.acceleration.set(this.force.x,this.force.y),this.acceleration.divide(this.mass),this.velocity.add(this.acceleration),this.position.add(this.velocity),this.force.set(0,0)}},{key:"render",value:function(){this.sprite&&this.sprite.position.set(this.position.x,this.position.y)}}]),e}();t.default=u}]).default}));