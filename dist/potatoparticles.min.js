!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("PIXI")):"function"==typeof define&&define.amd?define("PotatoParticles",["PIXI"],t):"object"==typeof exports?exports.PotatoParticles=t(require("PIXI")):e.PotatoParticles=t(e.PIXI)}(window,(function(e){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(t,i){t.exports=e},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=i}return n(e,[{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"setX",value:function(e){this.x=e}},{key:"setY",value:function(e){this.y=e}},{key:"add",value:function(t){this.x=e.roundAxis(this.x+t.x),this.y=e.roundAxis(this.y+t.y)}},{key:"subtract",value:function(t){this.x=e.roundAxis(this.x-t.x),this.y=e.roundAxis(this.y-t.y)}},{key:"multiply",value:function(t){this.x=e.roundAxis(this.x*t),this.y=e.roundAxis(this.y*t)}},{key:"divide",value:function(t){this.x=e.roundAxis(this.x/t),this.y=e.roundAxis(this.y/t)}},{key:"value",value:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"normalize",value:function(){var e=this.value();0!==e?(this.x/=e,this.y/=e):(this.x=0,this.y=0)}},{key:"clone",value:function(){return new e(this.x,this.y)}}],[{key:"add",value:function(e,t){var i=e.clone();return i.add(t),i}},{key:"subtract",value:function(e,t){var i=e.clone();return i.subtract(t),i}},{key:"multiply",value:function(e,t){var i=e.clone();return i.multiply(t),i}},{key:"divide",value:function(e,t){var i=e.clone();return i.divide(t),i}},{key:"roundAxis",value:function(e){return Math.round(1e5*e)/1e5}}]),e}();t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(3);var n,a=i(4);var r=((n=a)&&n.__esModule?n:{default:n}).default;t.default=r},function(e,t,i){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),r=u(i(5)),s=u(i(1)),o=u(i(6));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){var i=this,n=t.imageEl,a=t.pixelSize,s=void 0===a?10:a,o=t.particleSize,u=void 0===o?6:o,l=t.resistance,h=void 0===l?-.7:l,c=t.minMass,d=void 0===c?4:c,f=t.massRand,v=void 0===f?2:f,p=t.delayRand,y=void 0===p?.4:p,g=t.pixelFilter,m=t.particleInit,x=t.mouseInteraction,w=void 0===x||x;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.imageEl=n,this.pixelSize=s,this.particleSize=u,this.resistance=h,this.minMass=d,this.massRand=v,this.delayRand=y,this.pixelFilter=g,this.particleInit=m,this.mouseInteraction=w,this.imageHelper=new r.default,this.imageHelper.load(n.src).then((function(e){i.onLogoLoaded(e)}))}return n(e,[{key:"onLogoLoaded",value:function(e){this.width=e.width,this.height=e.height,this.particlesData=this.imageHelper.imageToDots({width:this.width,height:this.height,pixelSize:this.pixelSize,pixelFilter:this.pixelFilter}),this.mouseVector=new s.default(0,0),this.initRenderer(),this.initParticles(),this.renderer.render(this.stage),this.startLoop(),this.calculateScale(),this.bindEvents(),this.setParticlesTargets()}},{key:"initRenderer",value:function(){this.ticker=a.Ticker.shared,this.renderer=new a.Renderer({width:this.width,height:this.height,transparent:!0}),this.renderer.context.mozImageSmoothingEnabled=!1,this.renderer.context.webkitImageSmoothingEnabled=!1,this.canvasEl=this.renderer.view,this.imageEl.style.display="none",this.imageEl.parentElement.appendChild(this.canvasEl),this.stage=new a.Container,this.particleContainer=new a.Container,this.stage.addChild(this.particleContainer)}},{key:"initParticles",value:function(){this.particles=[];for(var e=this.particlesData.length,t=this.getShared(),i=this.particleInit||function(){return{}},n=0;n<e;n++){var r=this.particlesData[n],s=a.utils.rgb2hex([r.r,r.g,r.b]);this.particles.push(new o.default(this.particleContainer,Object.assign({x:t.avgX,y:t.avgY,mass:Math.random()*t.massRand+t.minMass,texture:this.createCircleTexture(t.particleSize/2,s,1),delay:(t.rangeY-(r.y-t.minY))*(2/t.rangeY)+Math.random()*t.delayRand},i(r,t))))}}},{key:"getShared",value:function(){for(var e=this.particlesData.length,t=this.particleSize,i=this.minMass,n=this.massRand,a=this.delayRand,r=0,s=0,o=this.particlesData[0].x,u=0,l=this.particlesData[0].y,h=0,c=0;c<e;c++){var d=this.particlesData[c];r+=d.x,s+=d.y,d.x<o&&(o=d.x),d.x>u&&(u=d.x),d.y<l&&(l=d.y),d.y>h&&(h=d.y)}return{width:this.width,height:this.height,halfWidth:this.width/2,halfHeight:this.height/2,particlesCount:e,particleSize:t,minMass:i,massRand:n,delayRand:a,minX:o,minY:l,maxX:u,maxY:h,sumX:r,sumY:s,avgX:r/e,avgY:s/e,rangeX:u-o,rangeY:h-l}}},{key:"createCircleTexture",value:function(e,t,i){var n=new a.Graphics;n.beginFill(t,i),n.drawCircle(0,0,e),n.endFill();var r=this.renderer.generateTexture(n);return n.clear(),n.destroy(),r}},{key:"calculateScale",value:function(){var e=this.canvasEl.getBoundingClientRect();this.scale=this.width/e.width}},{key:"setParticlesTargets",value:function(){for(var e=this.particlesData.length,t=0;t<e;t++){var i=this.particlesData[t];this.particles[t].setTarget(new s.default(i.x,i.y))}}},{key:"bindEvents",value:function(){window.addEventListener("resize",this.onResize.bind(this)),this.mouseInteraction&&window.addEventListener("mousemove",this.onMouseMove.bind(this))}},{key:"onResize",value:function(){this.calculateScale()}},{key:"onMouseMove",value:function(e){var t=this.canvasEl.getBoundingClientRect();this.mouseVector.set(e.clientX-t.left,e.clientY-t.top),this.mouseVector.multiply(this.scale)}},{key:"startLoop",value:function(){this.ticker.add(this.tick.bind(this))}},{key:"tick",value:function(e){this.update(e),this.render(1)}},{key:"update",value:function(e){for(var t=this.particles.length,i=0;i<t;i++){var n=this.particles[i];n.addForce(n.getForceToTarget()),this.mouseInteraction&&n.addForce(n.getMouseForce(this.mouseVector)),n.addForce(s.default.multiply(n.velocity,this.resistance)),n.update(e)}}},{key:"render",value:function(e){for(var t=this.particles.length,i=0;i<t;i++)this.particles[i].render(e);this.renderer.render(this.stage)}}]),e}();t.default=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isImageLoaded=!1,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}return n(e,[{key:"load",value:function(e){var t=this;return this.isImageLoaded=!1,new Promise((function(i){var n=new Image;n.onload=function(e){var n=e.target;t.onImageLoaded(n),i(n)},n.src=e}))}},{key:"onImageLoaded",value:function(e){this.image=e,this.width=this.image.width,this.height=this.image.height,this.isImageLoaded=!0}},{key:"checkImage",value:function(){return!!this.isImageLoaded}},{key:"imageToDots",value:function(e){if(!this.checkImage())return null;var t=this.image,i=e.width,n=void 0===i?t.width:i,a=e.height,r=void 0===a?t.height:a,s=e.pixelSize,o=void 0===s?1:s,u=e.pixelFilter,l=void 0===u?function(e){return e.a>=.4}:u,h=Math.ceil(n/o),c=Math.ceil(r/o);return this.canvas.setAttribute("width",h),this.canvas.setAttribute("height",c),this.imageToData(t,{canvasWidth:h,canvasHeight:c,pixelSize:o,pixelFilter:l})}},{key:"imageToData",value:function(e,t){var i=t.canvasWidth,n=t.canvasHeight,a=t.pixelSize,r=t.pixelFilter;this.ctx.clearRect(0,0,i,n),this.drawImageCover(e,i,n);for(var s=this.ctx.getImageData(0,0,i,n).data,o=[],u=0;u<n;u++)for(var l=0;l<i;l++){var h=4*(u*i+l),c={x:l*a,y:u*a,r:s[h+0]/255,g:s[h+1]/255,b:s[h+2]/255,a:s[h+3]/255};r(c)&&o.push(c)}return o}},{key:"drawImageCover",value:function(e,t,i){var n=Math.min(t/e.width,i/e.height),a={width:e.width*n,height:e.height*n},r={x:(t-a.width)/2,y:(i-a.height)/2};this.ctx.drawImage(e,0,0,e.width,e.height,r.x,r.y,a.width,a.height)}}]),e}();t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),s=i(1),o=(n=s)&&n.__esModule?n:{default:n};var u=function(){function e(t,i){var n=i.x,a=i.y,r=i.mass,s=void 0===r?1:r,u=i.texture,l=i.delay;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.position=new o.default(n,a),this.velocity=new o.default(0,0),this.acceleration=new o.default(0,0),this.force=new o.default(0,0),this.mass=s,this.target=this.position.clone(),this.waitFrames=60*l,this.waiting=this.waitFrames>0,t&&this.createSprite(t,{texture:u})}return a(e,[{key:"createSprite",value:function(e,t){var i=t.texture;this.sprite=new r.Sprite(i),this.sprite.anchor.set(.5),this.sprite.position.set(this.position.x,this.position.y),e.addChild(this.sprite)}},{key:"addForce",value:function(e){e&&this.force.add(e)}},{key:"setTarget",value:function(e){this.target=e}},{key:"getForceToTarget",value:function(){if(!this.target)return null;var e=o.default.subtract(this.target,this.position);return e.multiply(.04),e}},{key:"getMouseForce",value:function(e){var t=o.default.subtract(e,this.position),i=t.value();t.normalize();var n=120/i,a=n*n-.04,r=a<0?0:.8*a;return t.multiply(-r),t}},{key:"update",value:function(e){if(this.waiting){if(this.waitFrames-=e,this.waitFrames>0)return;return this.waitFrames=0,this.waiting=!1,void this.force.set(0,0)}this.acceleration.set(this.force.x,this.force.y),this.acceleration.divide(this.mass),this.velocity.add(this.acceleration),this.position.add(this.velocity),this.force.set(0,0)}},{key:"render",value:function(){this.sprite&&this.sprite.position.set(this.position.x,this.position.y)}}]),e}();t.default=u}]).default}));