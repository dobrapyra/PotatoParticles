!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("PIXI")):"function"==typeof define&&define.amd?define("PotatoParticles",["PIXI"],e):"object"==typeof exports?exports.PotatoParticles=e(require("PIXI")):t.PotatoParticles=e(t.PIXI)}(window,(function(t){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(e,i){e.exports=t},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i}return n(t,[{key:"set",value:function(t,e){this.x=t,this.y=e}},{key:"setX",value:function(t){this.x=t}},{key:"setY",value:function(t){this.y=t}},{key:"add",value:function(e){this.x=t.roundAxis(this.x+e.x),this.y=t.roundAxis(this.y+e.y)}},{key:"subtract",value:function(e){this.x=t.roundAxis(this.x-e.x),this.y=t.roundAxis(this.y-e.y)}},{key:"multiply",value:function(e){this.x=t.roundAxis(this.x*e),this.y=t.roundAxis(this.y*e)}},{key:"divide",value:function(e){this.x=t.roundAxis(this.x/e),this.y=t.roundAxis(this.y/e)}},{key:"value",value:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"normalize",value:function(){var t=this.value();0!==t?(this.x/=t,this.y/=t):(this.x=0,this.y=0)}},{key:"clone",value:function(){return new t(this.x,this.y)}}],[{key:"add",value:function(t,e){var i=t.clone();return i.add(e),i}},{key:"subtract",value:function(t,e){var i=t.clone();return i.subtract(e),i}},{key:"multiply",value:function(t,e){var i=t.clone();return i.multiply(e),i}},{key:"divide",value:function(t,e){var i=t.clone();return i.divide(e),i}},{key:"roundAxis",value:function(t){return Math.round(1e5*t)/1e5}}]),t}();e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(3);var n,r=i(4);var a=((n=r)&&n.__esModule?n:{default:n}).default;e.default=a},function(t,e,i){},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(0)),a=u(i(5)),s=u(i(1)),o=u(i(6));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(e){var i=this,n=e.rootEl,r=e.imageSrc,s=e.pixelSize,o=void 0===s?10:s,u=e.particleSize,l=void 0===u?6:u,h=e.resistance,c=void 0===h?-.7:h,d=e.minMass,f=void 0===d?4:d,v=e.massAmp,p=void 0===v?2:v,y=e.delayRand,g=void 0===y?.4:y,m=e.pixelFilter,x=e.mouseInteraction,w=void 0===x||x;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootEl=n,this.pixelSize=o,this.particleSize=l,this.resistance=c,this.minMass=f,this.massAmp=p,this.delayRand=g,this.pixelFilter=m,this.mouseInteraction=w,this.imageHelper=new a.default,this.imageHelper.load(r).then((function(t){i.onLogoLoaded(t),i.logoImage=t}))}return n(t,[{key:"onLogoLoaded",value:function(t){this.logoImage=t,this.width=this.logoImage.width,this.height=this.logoImage.height,this.particlesData=this.imageHelper.imageToDots({width:this.width,height:this.height,pixelSize:this.pixelSize,pixelFilter:this.pixelFilter}),this.mouseVector=new s.default(0,0),this.initRenderer(),this.initParticles(),this.renderer.render(this.stage),this.startLoop(),this.calculateScale(),this.bindEvents(),this.setParticlesTargets()}},{key:"initRenderer",value:function(){this.ticker=r.Ticker.shared,this.renderer=new r.Renderer({width:this.width,height:this.height,transparent:!0}),this.renderer.context.mozImageSmoothingEnabled=!1,this.renderer.context.webkitImageSmoothingEnabled=!1,this.rootEl.appendChild(this.renderer.view),this.stage=new r.Container,this.particleContainer=new r.Container,this.stage.addChild(this.particleContainer)}},{key:"initParticles",value:function(){this.particles=[];for(var t=this.particlesData.length,e=0,i=this.particlesData[0].y,n=0,a=0;a<t;a++)e+=this.particlesData[a].x,this.particlesData[a].y<i&&(i=this.particlesData[a].y),this.particlesData[a].y>n&&(n=this.particlesData[a].y);for(var s=e/t-this.width/2,u=n-i,l=2/u,h=this.particleSize,c=this.minMass,d=this.massAmp,f=this.delayRand,v=0;v<t;v++){var p=this.particlesData[v],y=r.utils.rgb2hex([p.r,p.g,p.b]);this.particles.push(new o.default(this.particleContainer,{x:Math.random()*this.width+s,y:-h,mass:Math.random()*d+c,texture:this.createCircleTexture(h/2,y,1),delay:(u-(p.y-i))*l+Math.random()*f}))}}},{key:"createCircleTexture",value:function(t,e,i){var n=new r.Graphics;n.beginFill(e,i),n.drawCircle(0,0,t),n.endFill();var a=this.renderer.generateTexture(n);return n.clear(),n.destroy(),a}},{key:"calculateScale",value:function(){var t=this.rootEl.getBoundingClientRect();this.scale=this.width/t.width}},{key:"setParticlesTargets",value:function(){for(var t=this.particlesData.length,e=0;e<t;e++){var i=this.particlesData[e];this.particles[e].setTarget(new s.default(i.x,i.y))}}},{key:"bindEvents",value:function(){window.addEventListener("resize",this.onResize.bind(this)),this.mouseInteraction&&window.addEventListener("mousemove",this.onMouseMove.bind(this))}},{key:"onResize",value:function(){this.calculateScale()}},{key:"onMouseMove",value:function(t){var e=this.rootEl.getBoundingClientRect();this.mouseVector.set(t.clientX-e.left,t.clientY-e.top),this.mouseVector.multiply(this.scale)}},{key:"startLoop",value:function(){this.ticker.add(this.tick.bind(this))}},{key:"tick",value:function(t){this.update(t),this.render(1)}},{key:"update",value:function(t){for(var e=this.particles.length,i=0;i<e;i++){var n=this.particles[i];n.addForce(n.getForceToTarget()),this.mouseInteraction&&n.addForce(n.getMouseForce(this.mouseVector)),n.addForce(s.default.multiply(n.velocity,this.resistance)),n.update(t)}}},{key:"render",value:function(t){for(var e=this.particles.length,i=0;i<e;i++)this.particles[i].render(t);this.renderer.render(this.stage)}}]),t}();e.default=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isImageLoaded=!1,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}return n(t,[{key:"load",value:function(t){var e=this;return this.isImageLoaded=!1,new Promise((function(i){var n=new Image;n.onload=function(t){var n=t.target;e.onImageLoaded(n),i(n)},n.src=t}))}},{key:"onImageLoaded",value:function(t){this.image=t,this.width=this.image.width,this.height=this.image.height,this.isImageLoaded=!0}},{key:"checkImage",value:function(){return!!this.isImageLoaded}},{key:"imageToDots",value:function(t){if(!this.checkImage())return null;var e=this.image,i=t.width,n=void 0===i?e.width:i,r=t.height,a=void 0===r?e.height:r,s=t.pixelSize,o=void 0===s?1:s,u=t.pixelFilter,l=void 0===u?function(t){return t.a>=.4}:u,h=Math.ceil(n/o),c=Math.ceil(a/o);return this.canvas.setAttribute("width",h),this.canvas.setAttribute("height",c),this.imageToData(e,{canvasWidth:h,canvasHeight:c,pixelSize:o,pixelFilter:l})}},{key:"imageToData",value:function(t,e){var i=e.canvasWidth,n=e.canvasHeight,r=e.pixelSize,a=e.pixelFilter;this.ctx.clearRect(0,0,i,n),this.drawImageCover(t,i,n);for(var s=this.ctx.getImageData(0,0,i,n).data,o=[],u=0;u<n;u++)for(var l=0;l<i;l++){var h=4*(u*i+l),c={x:l*r,y:u*r,r:s[h+0]/255,g:s[h+1]/255,b:s[h+2]/255,a:s[h+3]/255};a(c)&&o.push(c)}return o}},{key:"drawImageCover",value:function(t,e,i){var n=Math.min(e/t.width,i/t.height),r={width:t.width*n,height:t.height*n},a={x:(e-r.width)/2,y:(i-r.height)/2};this.ctx.drawImage(t,0,0,t.width,t.height,a.x,a.y,r.width,r.height)}}]),t}();e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(0)),s=i(1),o=(n=s)&&n.__esModule?n:{default:n};var u=function(){function t(e,i){var n=i.x,r=i.y,a=i.mass,s=void 0===a?1:a,u=i.texture,l=i.delay;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.position=new o.default(n,r),this.velocity=new o.default(0,0),this.acceleration=new o.default(0,0),this.force=new o.default(0,0),this.mass=s,this.target=this.position.clone(),this.waitFrames=60*l,this.waiting=this.waitFrames>0,e&&this.createSprite(e,{texture:u})}return r(t,[{key:"createSprite",value:function(t,e){var i=e.texture;this.sprite=new a.Sprite(i),this.sprite.anchor.set(.5),this.sprite.position.set(this.position.x,this.position.y),t.addChild(this.sprite)}},{key:"addForce",value:function(t){t&&this.force.add(t)}},{key:"setTarget",value:function(t){this.target=t}},{key:"getForceToTarget",value:function(){if(!this.target)return null;var t=o.default.subtract(this.target,this.position);return t.multiply(.04),t}},{key:"getMouseForce",value:function(t){var e=o.default.subtract(t,this.position),i=e.value();e.normalize();var n=120/i,r=n*n-.04,a=r<0?0:.8*r;return e.multiply(-a),e}},{key:"update",value:function(t){if(this.waiting){if(this.waitFrames-=t,this.waitFrames>0)return;return this.waitFrames=0,this.waiting=!1,void this.force.set(0,0)}this.acceleration.set(this.force.x,this.force.y),this.acceleration.divide(this.mass),this.velocity.add(this.acceleration),this.position.add(this.velocity),this.force.set(0,0)}},{key:"render",value:function(){this.sprite&&this.sprite.position.set(this.position.x,this.position.y)}}]),t}();e.default=u}]).default}));